<div class="catalogue">
  <!-- Search Component -->
  <app-search (searchChanged)="onSearchChanged($event)"></app-search>
  
  <div class="candles-grid">
    <!-- No Results Message -->
    @if (getProductsArray().length === 0 && searchTerm.trim()) {
      <div class="no-results">
        <i class="fas fa-search"></i>
        <h3>No candles found</h3>
        <p>Try searching for "Christmas", "Vanilla", "Berry" or other candle names</p>
      </div>
    }
    
    <!-- Generic Candle Card -->
    @for (product of getProductsArray(); track product.id) {
      <div class="candle-card" [class.sale-item]="isChristmasCandle(product)" (click)="openModal(product.id)">
        <!-- Sale Icon for Christmas Candles -->
        @if (isChristmasCandle(product)) {
          <div class="sale-icon" style="position: absolute; top: 5px; right: 5px; background: red; color: white; padding: 6px 10px; border-radius: 4px; font-weight: bold; z-index: 999; font-size: 12px; border: 2px solid white;">SALE</div>
        }
        
        <div class="candle-image-container" [style.position]="isChristmasCandle(product) ? 'relative' : 'initial'">
          <!-- Product Image -->
         
            <img [src]="product.image" [alt]="product.name" class="candle-image">
            
            <!-- Image Indicators for Multiple Images -->
            @if (hasMultipleImages(product)) {
              <div class="image-indicator">
                @for (img of product.images; track img; let i = $index) {
                  <span class="dot"></span>
                }
              </div>
            }
          
        </div>
        
        <h3>{{ product.name }}</h3>
        <p>{{ product.description }}</p>
        
        <!-- Social Icons -->
        <div class="social-icons">
          <a [href]="product.socialLinks.youtube" target="_blank" class="social-icon youtube-icon" title="Watch on YouTube" (click)="$event.stopPropagation()">
            <i class="fab fa-youtube"></i>
          </a>
          <a [href]="product.socialLinks.instagram" target="_blank" class="social-icon instagram-icon" title="View on Instagram" (click)="$event.stopPropagation()">
            <i class="fab fa-instagram"></i>
          </a>
        </div>
        
        <!-- Pricing -->
        <div class="price-container">
          @if (hasDiscountPricing(product)) {
            <span class="original-price">{{ getOriginalPrice(product) }}</span>
            <span class="discount-badge" style="color: #28a745; font-size: 12px; font-weight: bold; margin: 0 5px;">{{ calculateDiscount(product) }}</span>
          }
          <span class="price">{{ product.price.replace('â‚¹', '') }}</span>
        </div>
      </div>
    }
  </div>
</div>

<!-- Product Modal Component -->
@if (selectedProduct) {
  <app-product-modal 
    [product]="selectedProduct" 
    [isOpen]="isModalOpen" 
    (close)="closeModal()">
  </app-product-modal>
}
